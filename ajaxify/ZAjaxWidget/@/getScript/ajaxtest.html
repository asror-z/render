<link href="https://cdn.jsdelivr.net/npm/bootstrap-fileinput@5.0.8/css/fileinput.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/hint.css@2.6.0/hint.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/file-icon-vectors@1.0.0/dist/file-icon-classic.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/file-icon-vectors@1.0.0/dist/file-icon-square-o.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/file-icon-vectors@1.0.0/dist/file-icon-vivid.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/file-icon-vectors@1.0.0/dist/file-icon-vectors.min.css" rel="stylesheet">
<style>         .file-caption-info {
    font-size: 12px;
}

.file-size-info {
    font-size: 12px;
}

/*.kv-caption-icon{
  font-size: 100px;
}*/

.file-preview-other {
    display: flex;
    align-items: center;
    justify-content: center;
    /*margin-top: 4rem;*/
}</style>
<style>             .color-icon {
    color: transparent;
}

.ovr-button {
    overflow: visible !important;

}

.iconColor-w58 {
    color: #fff !important;
    font-size: px !important;
    /*  padding: 5px !important;
      padding-right: 10px !important;*/
}

.my-btn-icon {
    position: relative;
    left: 3px;
}

.counter {
    margin-left: -21px !important;
}

.eyeNoHover:hover {
    background: #fff !important;
}</style>
<style>             .color-icon {
    color: transparent;
}

.ovr-button {
    overflow: visible !important;

}

.iconColor-w59 {
    color: #fff !important;
    font-size: px !important;
    /*  padding: 5px !important;
      padding-right: 10px !important;*/
}

.my-btn-icon {
    position: relative;
    left: 3px;
}

.counter {
    margin-left: -21px !important;
}

.eyeNoHover:hover {
    background: #fff !important;
}</style>
<style>             .color-icon {
    color: transparent;
}

.ovr-button {
    overflow: visible !important;

}

.iconColor-w60 {
    color: #fff !important;
    font-size: px !important;
    /*  padding: 5px !important;
      padding-right: 10px !important;*/
}

.my-btn-icon {
    position: relative;
    left: 3px;
}

.counter {
    margin-left: -21px !important;
}

.eyeNoHover:hover {
    background: #fff !important;
}</style>
<style>             .color-icon {
    color: transparent;
}

.ovr-button {
    overflow: visible !important;

}

.iconColor-w61 {
    color: #fff !important;
    font-size: px !important;
    /*  padding: 5px !important;
      padding-right: 10px !important;*/
}

.my-btn-icon {
    position: relative;
    left: 3px;
}

.counter {
    margin-left: -21px !important;
}

.eyeNoHover:hover {
    background: #fff !important;
}</style>
<style>             .color-icon {
    color: transparent;
}

.ovr-button {
    overflow: visible !important;

}

.iconColor-w62 {
    color: #fff !important;
    font-size: px !important;
    /*  padding: 5px !important;
      padding-right: 10px !important;*/
}

.my-btn-icon {
    position: relative;
    left: 3px;
}

.counter {
    margin-left: -21px !important;
}

.eyeNoHover:hover {
    background: #fff !important;
}</style>
<style>
    .card-footer {
        padding-bottom: 0 !important;
    }

    .kv-panel-after {
        padding-bottom: 0 !important;
    }

    .card-body {
        padding: 10px !important;
    }
</style>

<div class="card border-primary">
    <div class="view overlay">
        <div class="card-header text-white bg-primary p-2">
            <div class="float-right m-0 p-0" style="margin-top: -4px!important;">
                <div class="summary mb-4 p-0 text-primary">
                </div>
            </div>
            <div class="m-0">
                <b>Виджеты</b>
            </div>
        </div>
    </div>
    <div class="card-body">
        <div class="file-loading">
            <input id="coreinput-string_2" name="CoreInput[string_2][]" type="file" multiple>
        </div>
        <div class="file-inputs" id="coreinput-string_2-inputs">

        </div>


    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>


<script src="https://cdn.jsdelivr.net/npm/bootstrap-fileinput@5.0.8/js/plugins/sortable.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-fileinput@5.0.8/js/plugins/purify.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-fileinput@5.0.8/js/plugins/piexif.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-fileinput@5.0.8/js/fileinput.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/5.4.0/bootbox.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.bundle.js"></script>

<script>$(document).ready(function () {
    $("#coreinput-string_2").fileinput({
        language: 'en',
        showCaption: true,
        showBrowse: true,
        showPreview: true,
        showRemove: true,
        showUpload: true,
        showUploadStats: true,
        showCancel: true,
        showPause: null,
        showClose: null,
        showUploadedThumbs: true,
        showConsoleLogs: true,
        browseOnZoneClick: false,
        autoReplace: false,
        autoOrientImage: function () { // applicable for JPEG images only and non ios safari
            var ua = window.navigator.userAgent, webkit = !!ua.match(/WebKit/i),
                iOS = !!ua.match(/iP(od|ad|hone)/i), iOSSafari = iOS && webkit && !ua.match(/CriOS/i);
            return !iOSSafari;
        },
        autoOrientImageInitial: true,
        required: false,
        rtl: false,
        hideThumbnailContent: false,
        encodeUrl: true,
        generateFileId: null,
        previewClass: '',
        captionClass: '',
        frameClass: 'krajee-default',
        mainClass: 'file-caption-main',
        mainTemplate: null,
        purifyHtml: true,
        fileSizeGetter: null,
        initialCaption: '',
        initialPreview: [],
        initialPreviewDelimiter: '*$$*',
        initialPreviewAsData: true,
        initialPreviewFileType: 'image',
        initialPreviewConfig: [],
        initialPreviewThumbTags: [],
        previewThumbTags: {},
        initialPreviewShowDelete: true,
        initialPreviewDownloadUrl: '',
        removeFromPreviewOnError: false,
        deleteUrl: "/kernel/widgettest/delete-file.aspx?modelClassName=CoreInput&attribute=string_2&id=",
        deleteExtraData: {},
        overwriteInitial: false,
        previewZoomButtonIcons: {
            prev: '<i class="glyphicon glyphicon-triangle-left"></i>',
            next: '<i class="glyphicon glyphicon-triangle-right"></i>',
            toggleheader: '<i class="glyphicon glyphicon-resize-vertical"></i>',
            fullscreen: '<i class="glyphicon glyphicon-fullscreen"></i>',
            borderless: '<i class="glyphicon glyphicon-resize-full"></i>',
            close: '<i class="glyphicon glyphicon-remove"></i>'
        },
        previewZoomButtonClasses: {
            prev: 'btn btn-navigate',
            next: 'btn btn-navigate',
            toggleheader: 'btn btn-sm btn-kv btn-default btn-outline-secondary',
            fullscreen: 'btn btn-sm btn-kv btn-default btn-outline-secondary',
            borderless: 'btn btn-sm btn-kv btn-default btn-outline-secondary',
            close: 'btn btn-sm btn-kv btn-default btn-outline-secondary'
        },
        previewTemplates: {},
        previewContentTemplates: {},
        preferIconicPreview: false,
        preferIconicZoomPreview: false,
        allowedFileTypes: null,
        allowedFileExtensions: null,
        allowedPreviewTypes: undefined,
        allowedPreviewMimeTypes: null,
        allowedPreviewExtensions: null,
        disabledPreviewTypes: undefined,
        disabledPreviewExtensions: ['msi', 'exe', 'com', 'zip', 'rar', 'app', 'vb', 'scr'],
        disabledPreviewMimeTypes: null,
        defaultPreviewContent: null,
        customLayoutTags: {},
        customPreviewTags: {},
        previewFileIcon: '<i class="glyphicon glyphicon-file"></i>',
        previewFileIconClass: 'file-other-icon',
        previewFileIconSettings: {
            'doc': '<i class="fa fa-file-word-o text-primary"></i>',
            'docx': '<i class="fa fa-file-word-o text-primary"></i>',
            'xls': '<i class="fa fa-file-excel-o text-success"></i>',
            'xlsx': '<i class="fa fa-file-excel-o text-success"></i>',
            'ppt': '<i class="fa fa-file-powerpoint-o text-danger"></i>',
            'jpg': '<i class="fa fa-file-photo-o text-warning"></i>',
            'pdf': '<i class="fa fa-file-pdf-o text-danger"></i>',
            'zip': '<i class="fa fa-file-archive-o text-muted"></i>',
        },
        previewFileExtSettings: {},
        buttonLabelClass: 'hidden-xs',
        browseIcon: '<i class="glyphicon glyphicon-folder-open"></i>&nbsp;',
        browseClass: 'btn btn-primary',
        removeIcon: '<i class="fas fa-trash"></i>',
        removeClass: 'btn btn-default btn-secondary',
        cancelIcon: '<i class="glyphicon glyphicon-ban-circle"></i>',
        cancelClass: 'btn btn-default btn-secondary',
        pauseIcon: '<i class="glyphicon glyphicon-pause"></i>',
        pauseClass: 'btn btn-default btn-secondary',
        uploadIcon: '<i class="glyphicon glyphicon-upload"></i>',
        uploadClass: 'btn btn-default btn-secondary',
        uploadUrl: "/kernel/widgettest/upload.aspx?modelClassName=CoreInput&attribute=string_2",
        uploadUrlThumb: "",
        uploadAsync: false,
        uploadParamNames: {
            chunkCount: 'chunkCount',
            chunkIndex: 'chunkIndex',
            chunkSize: 'chunkSize',
            chunkSizeStart: 'chunkSizeStart',
            chunksUploaded: 'chunksUploaded',
            fileBlob: 'fileBlob',
            fileId: 'fileId',
            fileName: 'fileName',
            fileRelativePath: 'fileRelativePath',
            fileSize: 'fileSize',
            retryCount: 'retryCount'
        },
        maxAjaxThreads: 5,
        processDelay: 100,
        queueDelay: 10, // must be lesser than process delay
        progressDelay: 0, // must be lesser than process delay
        enableResumableUpload: false,   // if it is true upload slowly
        resumableUploadOptions: {
            fallback: null,
            testUrl: null, // used for checking status of chunks/ files previously / partially uploaded
            chunkSize: 2 * 1024, // in KB
            maxThreads: 4,
            maxRetries: 3,
            showErrorLog: true
        },
        uploadExtraData: {},
        zoomModalHeight: 480,
        minImageWidth: null,
        minImageHeight: null,
        maxImageWidth: null,
        maxImageHeight: null,
        resizeImage: false,
        resizePreference: 'width',
        resizeQuality: 0.92,
        resizeDefaultImageType: 'image/jpeg',
        resizeIfSizeMoreThan: 0, // in KB
        minFileSize: 0,
        maxFileSize: 0,
        maxFilePreviewSize: 25600, // 25 MB
        minFileCount: 1,
        maxFileCount: 50,
        validateInitialCount: false,
        msgValidationErrorClass: 'text-danger',
        msgValidationErrorIcon: '<i class="glyphicon glyphicon-exclamation-sign"></i> ',
        msgErrorClass: 'file-error-message',
        progressThumbClass: 'progress-bar progress-bar-striped active',
        progressClass: 'progress-bar bg-success progress-bar-success progress-bar-striped active',
        progressInfoClass: 'progress-bar bg-info progress-bar-info progress-bar-striped active',
        progressCompleteClass: 'progress-bar bg-success progress-bar-success',
        progressPauseClass: 'progress-bar bg-primary progress-bar-primary progress-bar-striped active',
        progressErrorClass: 'progress-bar bg-danger progress-bar-danger',
        progressUploadThreshold: 99,
        previewFileType: 'image',
        elCaptionContainer: null,
        elCaptionText: null,
        elPreviewContainer: null,
        elPreviewImage: null,
        elPreviewStatus: null,
        elErrorContainer: null,
        slugCallback: function (filename) {
            return filename;
        },
        dropZoneEnabled: true,
        dropZoneTitleClass: 'file-drop-zone-title',
        fileActionSettings: {},
        otherActionButtons: '',
        textEncoding: 'UTF-8',
        actions: '',
        ajaxSettings: {},
        ajaxDeleteSettings: {},
        showAjaxErrorDetails: true,
        mergeAjaxCallbacks: false,
        mergeAjaxDeleteCallbacks: false,
        retryErrorUploads: true,
        reversePreviewOrder: false,
        usePdfRenderer: function () {
            //noinspection JSUnresolvedVariable
            var isIE11 = !!window.MSInputMethodContext && !!document.documentMode;
            return !!navigator.userAgent.match(/(iPod|iPhone|iPad|Android)/i) || isIE11;
        },
        pdfRendererUrl: '',
        pdfRendererTemplate: '<iframe class="kv-preview-data file-preview-pdf" src="{renderer}?file={data}" {style}></iframe>'
    }).on('filesorted', function (e, params) {
        console.log('file sorted', e, params);
    }).on('fileuploaded', function (e, params) {
        console.log('file uploaded', e, params);
    }).on('filebatchuploadsuccess', function (event, files) {
        var el = $("[name='CoreInput[string_2]']");
        var filesEl = el.val();
        var filesArr = [];
        /*    if(filesEl.length > 0)
             filesArr = JSON.parse(filesEl);*/

        $.each(files.files, function (fileName, file) {
            fileName = file.name;
            filesArr.push({name: fileName});

        });


        console.error(filesArr);
        $.each(filesArr, function (fileName, file) {
            fileName = file.name;
            var inputs = "<input type='' name='CoreInput[string_2][]' value='" + fileName + "' class='" + fileName + "'>";
            $('#coreinput-string_2-inputs').append(inputs);

            $('.file-caption-name').attr('title', fileName);

        });


        el.val(JSON.stringify(filesArr));


    }).on('filedeleted', function (event, id, index) {
        var el = $("[name='CoreInput[string_2]']");
        var filesEl = el.val();
        var filesArr = [];
        $.each(JSON.stringify(filesEl), function (fileName, file) {
            if (id === file.name) return;
            fileName = file.name;
            filesArr.push(fileName);
        });
        el.val(JSON.stringify(filesArr));
    })
        .on('filezoomshow', function (event, files) {
            $("[class='modal-header']").attr('style', 'background: white');
            $("[class='glyphicon glyphicon-resize-vertical']").attr('class', 'fas fa-fw fa-arrows-alt-v');
            $("[class='glyphicon glyphicon-fullscreen']").attr('class', 'fas fa-fw fa-arrows-alt');
            $("[class='glyphicon glyphicon-resize-full']").attr('class', 'fas fa-fw fa-external-link-alt');
            $("[class='glyphicon glyphicon-remove']").attr('class', 'fas fa-fw fa-times');
        }).on('filebatchselected', function (event, files) {
        reformatIcons();
    });
    reformatIcons();

    function reformatIcons() {

        $("[class='glyphicon glyphicon-trash']").attr('class', 'fas fa-trash');
        $("[class='glyphicon glyphicon-zoom-in']").attr('class', 'fas fa-search-plus');
        $("[class='glyphicon glyphicon-move']").attr('class', 'fas fa-arrows-alt');
        $("[class='glyphicon glyphicon-file']").attr('class', 'fas fa-file kv-caption-icon');
        $("[class='glyphicon glyphicon-upload']").attr('class', 'fas fa-upload');
        $("[class='glyphicon glyphicon-ban-circle']").attr('class', 'fas fa-ban');
        $("[class='glyphicon glyphicon-folder-open']").attr('class', 'fas fa-folder-open');

    }

    var isUpload63 = false;

    if (true) {
        $('.field-coreinput-string_2').find('.fileinput-upload-button').on('click', function () {
            return isUpload63 = true;

        });
        $(document).on('click', '.kv-file-upload', function () {
            $('#coreinput-string_2').fileinput('upload');
            return isUpload63 = true;
        });

    } else {

        $(document).on('click', '.kv-file-upload', function () {
            $('#coreinput-string_2').fileinput('upload');
        });
        return isUpload63 = true;
    }


    //console.log(isUpload63);

    $('.kv-form-horizontal').on('beforeValidate', function (e) {
        if (isUpload63) {
            return true;
        } else {
            $('#coreinput-string_2').fileinput('upload');
            return false;
        }

    });
});


$('#w58')
    .on('click',)
    .on('dblclick', function () {
        console.log("ZButtonWidget | $eventDblclick")
    })
    .on('keyup', function () {
        console.log("ZButtonWidget | $eventKeyup")
    })
    .on('mouseenter', function () {
        console.log("ZButtonWidget | $eventMouseEnter")
    })
    .on('mouseleave', function () {
        console.log("ZButtonWidget | $eventMouseLeave")
    });


$('#w59')
    .on('click',)
    .on('dblclick', function () {
        console.log("ZButtonWidget | $eventDblclick")
    })
    .on('keyup', function () {
        console.log("ZButtonWidget | $eventKeyup")
    })
    .on('mouseenter', function () {
        console.log("ZButtonWidget | $eventMouseEnter")
    })
    .on('mouseleave', function () {
        console.log("ZButtonWidget | $eventMouseLeave")
    });


$('#w60')
    .on('click',)
    .on('dblclick', function () {
        console.log("ZButtonWidget | $eventDblclick")
    })
    .on('keyup', function () {
        console.log("ZButtonWidget | $eventKeyup")
    })
    .on('mouseenter', function () {
        console.log("ZButtonWidget | $eventMouseEnter")
    })
    .on('mouseleave', function () {
        console.log("ZButtonWidget | $eventMouseLeave")
    });


$('#w61')
    .on('click',)
    .on('dblclick', function () {
        console.log("ZButtonWidget | $eventDblclick")
    })
    .on('keyup', function () {
        console.log("ZButtonWidget | $eventKeyup")
    })
    .on('mouseenter', function () {
        console.log("ZButtonWidget | $eventMouseEnter")
    })
    .on('mouseleave', function () {
        console.log("ZButtonWidget | $eventMouseLeave")
    });


$('#w62')
    .on('click',)
    .on('dblclick', function () {
        console.log("ZButtonWidget | $eventDblclick")
    })
    .on('keyup', function () {
        console.log("ZButtonWidget | $eventKeyup")
    })
    .on('mouseenter', function () {
        console.log("ZButtonWidget | $eventMouseEnter")
    })
    .on('mouseleave', function () {
        console.log("ZButtonWidget | $eventMouseLeave")
    });


</script>

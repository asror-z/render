
<!DOCTYPE html>
<html lang="en">
  <head>

    <title>EasyTimer.js</title>

  </head>

  <body>
  <div class="basic stopwatch"></div>
  <button onclick="Stopwatch.stop()">STOP!</button>

  <style>

    .stopwatch {
      display: inline-block;
      background-color: white;
      border: 1px solid #eee;
      padding: 5px;
      margin: 5px;
    }
    .stopwatch span {
      font-weight: bold;
      display: block;
    }
    .stopwatch a {
      padding-right: 5px;
      text-decoration: none;
    }
  </style>
    <script>
      var Stopwatch = {
        init: function(elem, options) {

          var timer = createTimer(),
                  startButton = createButton("start", start),
                  stopButton = createButton("stop", stop),
                  resetButton = createButton("reset", reset),
                  offset,
                  clock,
                  interval;

          // default options
          options = options || {};
          options.delay = options.delay || 1;

          // append elements
          elem.appendChild(timer);
          elem.appendChild(startButton);
          elem.appendChild(stopButton);
          elem.appendChild(resetButton);

          // initialize
          reset();

          // private functions
          function createTimer() {
            return document.createElement("span");
          }

          function createButton(action, handler) {
            var a = document.createElement("a");
            a.href = "#" + action;
            a.innerHTML = action;
            a.addEventListener("click", function(event) {
              handler();
              event.preventDefault();
            });
            return a;
          }

          function start() {
            if (!interval) {
              offset = Date.now();
              interval = setInterval(update, options.delay);
            }
          }

          function stop() {
            if (interval) {
              clearInterval(interval);
              interval = null;
            }
          }

          function reset() {
            clock = 0;
            render(0);
          }

          function update() {
            clock += delta();
            render();
          }

          function render() {
            timer.innerHTML = clock / 1000;
          }

          function delta() {
            var now = Date.now(),
                    d = now - offset;

            offset = now;
            return d;
          }

          // public API
          this.start = start;
          this.stop = stop;
          this.reset = reset;
        }
      };

      // basic examples
      var elems = document.getElementsByClassName("basic");

      for (var i = 0, len = elems.length; i < len; i++) {
        Stopwatch.init(elems[i]);
      }</script>
  </body>
</html>
